<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Privilege Escalation Example</title>
</head>
<body>
  <h1>Privilege Escalation Example</h1>

  <script>
    // Spray di buffer
    function sprayBuffer(count, size) {
      let spray = [];
      for (let i = 0; i < count; i++) {
        spray.push(new ArrayBuffer(size)); // Creiamo buffer
      }
      return spray;
    }

    // Privilege escalation function
    function escalatePrivileges() {
      alert("Privilegi elevati ottenuti!");
      // Esegui codice privilegiato qui
    }

    // Buffer per spruzzare la memoria
    let externalMemory = new Uint8Array(0x100);
    sprayBuffer(5000, 0x100); // Sprayiamo buffer

    alert("Creazione e corruzione del TypedArray...");
    const handle = createCorruptedTypedArray(externalMemory.buffer, 0x100);

    // Modifica del flag dei privilegi
    alert("Modifica i privilegi...");
    handle.view[0x100] = escalatePrivileges; // Modifichiamo il flag privilegiato

    // Chiamata alla funzione corrotto che esegue codice elevato
    alert("Esecuzione della funzione corrotto con privilegi elevati...");
    handle.view[0x100]();  // Questa esegue escalatePrivileges
  </script>
</body>
</html>
